{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"rQw_9hzGSCDF"},"outputs":[],"source":["from os import scandir, getcwd\n","import cv2\n","import numpy as np\n","import pandas as pd\n","\n","def ls(ruta):\n","    return [arch.name for arch in scandir(ruta) if arch.is_file()]\n","\n","width = 28\n","height = 28"]},{"cell_type":"markdown","metadata":{"id":"OFezVyfccRgi"},"source":["Image to CSV and  Preprocessing using Area interpolation method_Test  images"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A--3ovthCGrS"},"outputs":[],"source":["test_abdomen_path = '/content/drive/MyDrive/Dataset/Spanish dataset/ABDOMEN/test_abdomen/'\n","test_thorax_path = '/content/drive/MyDrive/Dataset/Spanish dataset/THORAX/test_thorax/'\n","test_femur_path = '/content/drive/MyDrive/Dataset/Spanish dataset/FEMUR/test_femur/'\n","test_maternal_cervix_path ='/content/drive/MyDrive/Dataset/Spanish dataset/MATERAL CERVIX/test_cervix/'\n","test_other_path ='/content/drive/MyDrive/Dataset/Spanish dataset/OTHER/test_other/'\n","test_brain_path ='/content/drive/MyDrive/Dataset/Spanish dataset/BRAIN/test_brain/'\n","list_abdomen_test = []\n","list_thorax_test = []\n","list_femur_test = []\n","list_maternal_cervix_test = []\n","list_other_test = []\n","list_brain_test = []"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e6CCSRfvOJxp","collapsed":true},"outputs":[],"source":["files_0 = ls(test_abdomen_path)\n","\n","for image in files_0:\n","\timg = cv2.imread(test_abdomen_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),0)\n","\tlist_abdomen_test.append(imagen_entrada)\n","df_abdomen_test = pd.DataFrame(data=list_abdomen_test, index=[i for i in range(len(list_abdomen_test))])\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8pYI8oVtObDI"},"outputs":[],"source":["files_1 = ls(test_thorax_path)\n","for image in files_1:\n","\timg = cv2.imread(test_thorax_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),1)\n","\tlist_thorax_test.append(imagen_entrada)\n","df_thorax_test = pd.DataFrame(data=list_thorax_test, index=[i for i in range(len(list_thorax_test))])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4tcz6lSBOsMc"},"outputs":[],"source":["files_2 = ls(test_femur_path)\n","for image in files_2:\n","\timg = cv2.imread(test_femur_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),2)\n","\tlist_femur_test.append(imagen_entrada)\n","df_femur_test = pd.DataFrame(data=list_femur_test, index=[i for i in range(len(list_femur_test))])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aUjDuRhiWbK-"},"outputs":[],"source":["files_3 = ls(test_maternal_cervix_path)\n","for image in files_3:\n","\timg = cv2.imread(test_maternal_cervix_path+image,0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),3)\n","\tlist_maternal_cervix_test.append(imagen_entrada)\n","df_maternal_cervix_test = pd.DataFrame(data=list_maternal_cervix_test, index=[i for i in range(len(list_maternal_cervix_test))])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tovEw3StW32H"},"outputs":[],"source":["files_4 = ls(test_other_path)\n","for image in files_4:\n","\timg = cv2.imread(test_other_path+image,0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),4)\n","\tlist_other_test.append(imagen_entrada)\n","df_other_test = pd.DataFrame(data=list_other_test, index=[i for i in range(len(list_other_test))])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uWaAVw05XCiP"},"outputs":[],"source":["files_5 = ls(test_brain_path)\n","for image in files_5:\n","\timg = cv2.imread(test_brain_path+image,0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),5)\n","\tlist_brain_test.append(imagen_entrada)\n","df_brain_test = pd.DataFrame(data=list_brain_test, index=[i for i in range(len(list_brain_test))])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yq5SutUaO4E6"},"outputs":[],"source":["dframes_test = [df_abdomen_test, df_thorax_test, df_femur_test,df_maternal_cervix_test,df_other_test,df_brain_test]\n","df_test = pd.concat(dframes_test)\n","print(df_test)\n","file_path = '/content/drive/MyDrive/Dataset/npy files/test_spanish.csv'\n","df_test.to_csv(file_path, header=None, index=False)"]},{"cell_type":"markdown","source":["Image to CSV and  Preprocessing using Area interpolation method_Train  images"],"metadata":{"id":"lKlyfUqW4b5S"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"EBXPQx7NPF4b"},"outputs":[],"source":["train_abdomen_path = '/content/drive/MyDrive/Dataset/Spanish dataset/ABDOMEN/training_abdomen/'\n","train_thorax_path = '/content/drive/MyDrive/Dataset/Spanish dataset/THORAX/training1_thorax/'\n","train_femur_path = '/content/drive/MyDrive/Dataset/Spanish dataset/FEMUR/training1_femur/'\n","train_maternal_cervix_path ='/content/drive/MyDrive/Dataset/Spanish dataset/MATERAL CERVIX/training_cervix/'\n","train_other_path ='/content/drive/MyDrive/Dataset/Spanish dataset/OTHER/training_other/'\n","train_brain_path ='/content/drive/MyDrive/Dataset/Spanish dataset/BRAIN/training_brain/'\n","list_abdomen_train = []\n","list_thorax_train = []\n","list_femur_train = []\n","list_maternal_cervix_train = []\n","list_other_train = []\n","list_brain_train = []\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l80Bi_FMP24u"},"outputs":[],"source":["files_0 = ls(train_abdomen_path)\n","\n","for image in files_0:\n","\timg = cv2.imread(train_abdomen_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),0)\n","\tlist_abdomen_train.append(imagen_entrada)\n","\n","df_abdomen_train = pd.DataFrame(data=list_abdomen_train, index=[i for i in range(len(list_abdomen_train))])\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G8BbzZMdQAr3"},"outputs":[],"source":["files_1 = ls(train_thorax_path)\n","print(len(files_1))\n","for image in files_1:\n","\timg = cv2.imread(train_thorax_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),1)\n","\tlist_thorax_train.append(imagen_entrada)\n","\n","df_thorax_train = pd.DataFrame(data=list_thorax_train, index=[i for i in range(len(list_thorax_train))])\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n2JOUqFpQgxX"},"outputs":[],"source":["files_2 = ls(train_femur_path)\n","for image in files_2:\n","\timg = cv2.imread(train_femur_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),2)\n","\tlist_femur_train.append(imagen_entrada)\n","\n","df_femur_train = pd.DataFrame(data=list_femur_train, index=[i for i in range(len(list_femur_train))])"]},{"cell_type":"code","source":["files_3 = ls(train_maternal_cervix_path)\n","for image in files_3:\n","\timg = cv2.imread(train_maternal_cervix_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),3)\n","\tlist_maternal_cervix_train.append(imagen_entrada)\n","\n","df_maternal_cervix_train = pd.DataFrame(data=list_maternal_cervix_train, index=[i for i in range(len(list_maternal_cervix_train))])"],"metadata":{"id":"rYjEITZllvGY"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"c4SFB4UBa2RY"},"outputs":[],"source":["files_4 = ls(train_other_path)\n","for image in files_4:\n","\timg = cv2.imread(train_other_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),4)\n","\tlist_other_train.append(imagen_entrada)\n","\n","df_other_train = pd.DataFrame(data=list_other_train, index=[i for i in range(len(list_other_train))])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_egpFcX0b6AY"},"outputs":[],"source":["files_5 = ls(train_brain_path)\n","for image in files_5:\n","\timg = cv2.imread(train_brain_path+image, 0)\n","\tdim = (width, height)\n","\timagen_entrada = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)\n","\timagen_entrada = imagen_entrada.flatten()\n","\timagen_entrada = np.insert(imagen_entrada,len(imagen_entrada),5)\n","\tlist_brain_train.append(imagen_entrada)\n","\n","df_brain_train = pd.DataFrame(data=list_brain_train, index=[i for i in range(len(list_brain_train))])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MJlpC1W9QyhA"},"outputs":[],"source":["dframes_train = [df_abdomen_train, df_thorax_train, df_femur_train,df_maternal_cervix_train,df_other_train,df_brain_train]\n","df_train = pd.concat(dframes_train)\n","print(df_train)\n","file_path = '/content/drive/MyDrive/Dataset/npy files/train_fetus_spanish.csv'\n","df_train.to_csv(file_path, header=None, index=False)\n"]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyNT+TFL6EUaQMOWe7j0wpMK"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}